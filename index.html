<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üê∫ BTC Analyzer - An√°lise T√©cnica Di√°ria</title>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --text-primary: #f0f6fc;
            --text-secondary: #8b949e;
            --accent-green: #3fb950;
            --accent-red: #f85149;
            --accent-yellow: #d29922;
            --accent-blue: #58a6ff;
            --border-color: #30363d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 30px;
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        header .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .price-banner {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .price-banner .price {
            font-size: 3rem;
            font-weight: bold;
            color: var(--accent-blue);
        }
        
        .price-banner .change {
            font-size: 1.2rem;
            margin-top: 10px;
        }
        
        .change.positive { color: var(--accent-green); }
        .change.negative { color: var(--accent-red); }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 25px;
        }
        
        .card h2 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .indicator-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--bg-tertiary);
        }
        
        .indicator-row:last-child {
            border-bottom: none;
        }
        
        .indicator-label {
            color: var(--text-secondary);
        }
        
        .indicator-value {
            font-weight: 600;
        }
        
        .wyckoff-phase {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
        }
        
        .phase-status {
            font-size: 1.2rem;
        }
        
        .scenario-box {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }
        
        .scenario-box .scenario-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-yellow);
        }
        
        .scenario-box .probability {
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .levels-list {
            list-style: none;
        }
        
        .levels-list li {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
        }
        
        .resistance {
            background: rgba(248, 81, 73, 0.1);
            border-left: 3px solid var(--accent-red);
        }
        
        .support {
            background: rgba(63, 185, 80, 0.1);
            border-left: 3px solid var(--accent-green);
        }
        
        .current-price {
            background: rgba(88, 166, 255, 0.2);
            border-left: 3px solid var(--accent-blue);
            font-weight: bold;
        }
        
        .signal-box {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .signal-long {
            background: rgba(63, 185, 80, 0.1);
            border: 1px solid var(--accent-green);
        }
        
        .signal-short {
            background: rgba(248, 81, 73, 0.1);
            border: 1px solid var(--accent-red);
        }
        
        .disclaimer {
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-yellow);
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            text-align: center;
        }
        
        .disclaimer h3 {
            color: var(--accent-yellow);
            margin-bottom: 10px;
        }
        
        .update-time {
            text-align: center;
            color: var(--text-secondary);
            margin-top: 20px;
            padding: 20px;
        }
        
        footer {
            text-align: center;
            padding: 30px;
            color: var(--text-secondary);
            border-top: 1px solid var(--border-color);
            margin-top: 40px;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
        }
        
        .spinner {
            border: 4px solid var(--bg-tertiary);
            border-top: 4px solid var(--accent-blue);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            header h1 { font-size: 1.8rem; }
            .price-banner .price { font-size: 2rem; }
            .grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <h1>üê∫ BTC Analyzer</h1>
        <p class="subtitle">An√°lise T√©cnica Automatizada - Wyckoff, Elliott Wave, Suportes e Resist√™ncias</p>
    </header>
    
    <div class="container">
        <div id="content">
            <div class="loading">
                <div class="spinner"></div>
                <p>Carregando an√°lise...</p>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Criado por Lobo üê∫ | Cultura Builder</p>
        <p style="margin-top: 10px; font-size: 0.9rem;">Dados: CoinGecko API | Atualiza√ß√£o: Di√°ria</p>
    </footer>

    <script>
        // Configura√ß√£o
        const COINGECKO_API = 'https://api.coingecko.com/api/v3';
        
        // Busca dados
        async function fetchData() {
            try {
                // Pre√ßo atual
                const priceRes = await fetch(`${COINGECKO_API}/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true`);
                const priceData = await priceRes.json();
                
                // Hist√≥rico
                const histRes = await fetch(`${COINGECKO_API}/coins/bitcoin/market_chart?vs_currency=usd&days=200`);
                const histData = await histRes.json();
                
                return {
                    currentPrice: priceData.bitcoin.usd,
                    change24h: priceData.bitcoin.usd_24h_change,
                    prices: histData.prices,
                    volumes: histData.total_volumes
                };
            } catch (error) {
                console.error('Erro ao buscar dados:', error);
                return null;
            }
        }
        
        // Calcula RSI
        function calculateRSI(prices, period = 14) {
            const changes = [];
            for (let i = 1; i < prices.length; i++) {
                changes.push(prices[i] - prices[i-1]);
            }
            
            let gains = 0, losses = 0;
            for (let i = changes.length - period; i < changes.length; i++) {
                if (changes[i] > 0) gains += changes[i];
                else losses -= changes[i];
            }
            
            const avgGain = gains / period;
            const avgLoss = losses / period;
            const rs = avgGain / avgLoss;
            return 100 - (100 / (1 + rs));
        }
        
        // Calcula SMA
        function calculateSMA(prices, period) {
            const slice = prices.slice(-period);
            return slice.reduce((a, b) => a + b, 0) / period;
        }
        
        // An√°lise Wyckoff
        function analyzeWyckoff(prices, currentPrice) {
            const ath = Math.max(...prices);
            const dropFromATH = ((ath - currentPrice) / ath) * 100;
            
            let scenario, probability;
            if (dropFromATH > 25) {
                scenario = 'DISTRIBUI√á√ÉO CONFIRMADA';
                probability = 70;
            } else if (dropFromATH > 15) {
                scenario = 'POSS√çVEL DISTRIBUI√á√ÉO';
                probability = 55;
            } else if (dropFromATH > 10) {
                scenario = 'CORRE√á√ÉO / INDEFINIDO';
                probability = 45;
            } else {
                scenario = 'TEND√äNCIA DE ALTA';
                probability = 40;
            }
            
            return {
                ath,
                dropFromATH,
                scenario,
                probability,
                phases: {
                    PSY: { status: '‚úÖ', desc: 'Preliminary Supply' },
                    BC: { status: '‚úÖ', desc: `Buying Climax em $${ath.toLocaleString()}` },
                    AR: { status: dropFromATH > 10 ? '‚úÖ' : 'üîÑ', desc: 'Automatic Reaction' },
                    ST: { status: '‚ö†Ô∏è', desc: 'Secondary Test' },
                    SOW: { status: 'üîÑ', desc: 'Sign of Weakness em teste' }
                }
            };
        }
        
        // Encontra suportes e resist√™ncias
        function findLevels(prices) {
            const resistances = [];
            const supports = [];
            
            for (let i = 10; i < prices.length - 10; i++) {
                const window = prices.slice(i - 5, i + 5);
                const max = Math.max(...window);
                const min = Math.min(...window);
                
                if (prices[i] === max) resistances.push(prices[i]);
                if (prices[i] === min) supports.push(prices[i]);
            }
            
            // Agrupa n√≠veis pr√≥ximos
            const clusterLevels = (levels) => {
                if (levels.length === 0) return [];
                levels.sort((a, b) => b - a);
                const clusters = [];
                let current = [levels[0]];
                
                for (let i = 1; i < levels.length; i++) {
                    if ((current[0] - levels[i]) / current[0] < 0.03) {
                        current.push(levels[i]);
                    } else {
                        clusters.push(current.reduce((a, b) => a + b) / current.length);
                        current = [levels[i]];
                    }
                }
                clusters.push(current.reduce((a, b) => a + b) / current.length);
                return clusters.slice(0, 5);
            };
            
            return {
                resistances: clusterLevels(resistances),
                supports: clusterLevels(supports)
            };
        }
        
        // Fibonacci levels
        function calculateFibonacci(high, low) {
            const range = high - low;
            return {
                '0.236': high - range * 0.236,
                '0.382': high - range * 0.382,
                '0.500': high - range * 0.500,
                '0.618': high - range * 0.618,
                '0.786': high - range * 0.786
            };
        }
        
        // Renderiza p√°gina
        function render(data) {
            const prices = data.prices.map(p => p[1]);
            const currentPrice = data.currentPrice;
            const change24h = data.change24h;
            
            const rsi = calculateRSI(prices);
            const sma20 = calculateSMA(prices, 20);
            const sma50 = calculateSMA(prices, 50);
            const sma200 = calculateSMA(prices, 200);
            
            const wyckoff = analyzeWyckoff(prices, currentPrice);
            const levels = findLevels(prices);
            const fib = calculateFibonacci(wyckoff.ath, Math.min(...prices));
            
            const changeClass = change24h >= 0 ? 'positive' : 'negative';
            const changeSign = change24h >= 0 ? '+' : '';
            
            // Determina vi√©s
            let bias = 'NEUTRO';
            let biasColor = 'var(--accent-yellow)';
            if (rsi < 30) { bias = 'OVERSOLD - Poss√≠vel bounce'; biasColor = 'var(--accent-green)'; }
            else if (rsi > 70) { bias = 'OVERBOUGHT - Poss√≠vel corre√ß√£o'; biasColor = 'var(--accent-red)'; }
            else if (currentPrice < sma200) { bias = 'BEARISH - Abaixo da SMA200'; biasColor = 'var(--accent-red)'; }
            else if (currentPrice > sma50) { bias = 'BULLISH - Acima das m√©dias'; biasColor = 'var(--accent-green)'; }
            
            document.getElementById('content').innerHTML = `
                <div class="price-banner">
                    <div class="price">$${currentPrice.toLocaleString()}</div>
                    <div class="change ${changeClass}">${changeSign}${change24h.toFixed(2)}% (24h)</div>
                </div>
                
                <div class="grid">
                    <div class="card">
                        <h2>üìä Indicadores</h2>
                        <div class="indicator-row">
                            <span class="indicator-label">RSI (14)</span>
                            <span class="indicator-value" style="color: ${rsi < 30 ? 'var(--accent-green)' : rsi > 70 ? 'var(--accent-red)' : 'inherit'}">${rsi.toFixed(1)}</span>
                        </div>
                        <div class="indicator-row">
                            <span class="indicator-label">SMA 20</span>
                            <span class="indicator-value">$${sma20.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                        </div>
                        <div class="indicator-row">
                            <span class="indicator-label">SMA 50</span>
                            <span class="indicator-value">$${sma50.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                        </div>
                        <div class="indicator-row">
                            <span class="indicator-label">SMA 200</span>
                            <span class="indicator-value">$${sma200.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                        </div>
                        <div class="indicator-row">
                            <span class="indicator-label">Vi√©s</span>
                            <span class="indicator-value" style="color: ${biasColor}">${bias.split(' - ')[0]}</span>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>üìâ An√°lise Wyckoff</h2>
                        <div class="indicator-row">
                            <span class="indicator-label">ATH</span>
                            <span class="indicator-value">$${wyckoff.ath.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                        </div>
                        <div class="indicator-row">
                            <span class="indicator-label">Queda do ATH</span>
                            <span class="indicator-value" style="color: var(--accent-red)">${wyckoff.dropFromATH.toFixed(1)}%</span>
                        </div>
                        ${Object.entries(wyckoff.phases).map(([phase, data]) => `
                            <div class="wyckoff-phase">
                                <span class="phase-status">${data.status}</span>
                                <span><strong>${phase}</strong>: ${data.desc}</span>
                            </div>
                        `).join('')}
                        <div class="scenario-box">
                            <div class="scenario-name">${wyckoff.scenario}</div>
                            <div class="probability">Probabilidade: ${wyckoff.probability}%</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>üéØ Suportes e Resist√™ncias</h2>
                        <ul class="levels-list">
                            ${levels.resistances.filter(r => r > currentPrice).slice(0, 3).map(r => `
                                <li class="resistance">
                                    <span>üî¥ Resist√™ncia</span>
                                    <span>$${r.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                                </li>
                            `).join('')}
                            <li class="current-price">
                                <span>üìç Pre√ßo Atual</span>
                                <span>$${currentPrice.toLocaleString()}</span>
                            </li>
                            ${levels.supports.filter(s => s < currentPrice).slice(0, 3).map(s => `
                                <li class="support">
                                    <span>üü¢ Suporte</span>
                                    <span>$${s.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h2>üìê N√≠veis Fibonacci</h2>
                        ${Object.entries(fib).map(([level, price]) => `
                            <div class="indicator-row">
                                <span class="indicator-label">${(parseFloat(level) * 100).toFixed(1)}%</span>
                                <span class="indicator-value">$${price.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="grid">
                    <div class="card">
                        <h2>üìà Sinais LONG</h2>
                        <div class="signal-box signal-long">
                            <strong>Entrada Agressiva:</strong> $${(currentPrice * 0.95).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Stop Loss:</strong> $${(currentPrice * 0.92).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Take Profit:</strong> $${(currentPrice * 1.10).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>R/R:</strong> 1:3.3
                        </div>
                        <div class="signal-box signal-long">
                            <strong>Entrada Conservadora:</strong> $${(fib['0.618']).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Stop Loss:</strong> $${(fib['0.786']).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Take Profit:</strong> $${(currentPrice * 1.15).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>R/R:</strong> 1:4
                        </div>
                        <div class="signal-box signal-long">
                            <strong>Entrada "Gift":</strong> $${(fib['0.786']).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Stop Loss:</strong> $${(fib['0.786'] * 0.95).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Take Profit:</strong> $${sma50.toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>R/R:</strong> 1:5+
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>üìâ Sinais SHORT</h2>
                        <div class="signal-box signal-short">
                            <strong>Entrada:</strong> $${(sma20).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Stop Loss:</strong> $${(sma20 * 1.03).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Take Profit:</strong> $${(currentPrice * 0.90).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>R/R:</strong> 1:3
                        </div>
                        <div class="signal-box signal-short">
                            <strong>Entrada:</strong> $${(fib['0.382']).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Stop Loss:</strong> $${(fib['0.236']).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Take Profit:</strong> $${(fib['0.618']).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>R/R:</strong> 1:3.5
                        </div>
                        <div class="signal-box signal-short">
                            <strong>Entrada Wyckoff LPSY:</strong> $${(sma50).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Stop Loss:</strong> $${(sma50 * 1.04).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Take Profit:</strong> $${(wyckoff.ath * 0.60).toLocaleString(undefined, {maximumFractionDigits: 0})}<br>
                            <strong>Tipo:</strong> Last Point of Supply
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h2>üéØ Alvos Wyckoff</h2>
                    <div class="grid" style="margin-top: 15px;">
                        <div>
                            <h4 style="color: var(--accent-red);">Se DISTRIBUI√á√ÉO:</h4>
                            <p>Alvo 1: $${(wyckoff.ath * 0.70).toLocaleString(undefined, {maximumFractionDigits: 0})}</p>
                            <p>Alvo 2: $${(wyckoff.ath * 0.60).toLocaleString(undefined, {maximumFractionDigits: 0})}</p>
                            <p>Alvo 3: $${(wyckoff.ath * 0.50).toLocaleString(undefined, {maximumFractionDigits: 0})}</p>
                        </div>
                        <div>
                            <h4 style="color: var(--accent-green);">Se RE-ACUMULA√á√ÉO:</h4>
                            <p>Spring: $${(currentPrice * 0.90).toLocaleString(undefined, {maximumFractionDigits: 0})}</p>
                            <p>SOS: $${(sma50).toLocaleString(undefined, {maximumFractionDigits: 0})}</p>
                            <p>Breakout: $${(wyckoff.ath * 1.10).toLocaleString(undefined, {maximumFractionDigits: 0})}</p>
                        </div>
                    </div>
                </div>
                
                <div class="disclaimer">
                    <h3>‚ö†Ô∏è DISCLAIMER</h3>
                    <p>Esta an√°lise √© <strong>educacional</strong> e n√£o constitui recomenda√ß√£o de investimento.</p>
                    <p>Sempre use gerenciamento de risco e stop loss. O mercado pode fazer qualquer coisa.</p>
                </div>
                
                <div class="update-time">
                    <p>√öltima atualiza√ß√£o: ${new Date().toLocaleString('pt-BR')}</p>
                    <p>Pr√≥xima atualiza√ß√£o autom√°tica: em 24 horas</p>
                </div>
            `;
        }
        
        // Inicializa
        async function init() {
            const data = await fetchData();
            if (data) {
                render(data);
            } else {
                document.getElementById('content').innerHTML = `
                    <div class="card" style="text-align: center;">
                        <h2>‚ùå Erro ao carregar dados</h2>
                        <p>Tente novamente em alguns minutos.</p>
                        <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; cursor: pointer;">
                            Recarregar
                        </button>
                    </div>
                `;
            }
        }
        
        init();
        
        // Atualiza a cada 5 minutos
        setInterval(init, 5 * 60 * 1000);
    </script>
</body>
</html>
